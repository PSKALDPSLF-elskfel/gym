# è¯¾ç¨‹ç®¡ç†åŠŸèƒ½å¼€å‘æ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ¬¡å¼€å‘å®Œå–„äº†å¥èº«æˆ¿é¢„çº¦ç³»ç»Ÿçš„è¯¾ç¨‹ç®¡ç†åŠŸèƒ½ï¼Œä¸»è¦æ˜¯åœ¨ç°æœ‰è¯¾ç¨‹ç®¡ç†åŸºç¡€ä¸Šæ·»åŠ äº†**è¯¾ç¨‹åˆ†ç±»**å’Œ**æ•™ç»ƒå…³è”**åŠŸèƒ½ã€‚

---

## ğŸ¯ å¼€å‘ç›®æ ‡

æ ¹æ®æ•°æ®åº“è¡¨ç»“æ„ `gym_course`ï¼Œè¯¾ç¨‹è¡¨åŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š
- `category_id` - è¯¾ç¨‹åˆ†ç±»ID
- `coach_id` - æ•™ç»ƒID

ä½†åŸæœ‰ä»£ç ä¸­è¿™ä¸¤ä¸ªå­—æ®µ**æ²¡æœ‰å®ç°**ï¼Œæœ¬æ¬¡å¼€å‘çš„ç›®æ ‡æ˜¯ï¼š
1. âœ… åœ¨å®ä½“ç±»ã€DTOã€Serviceä¸­æ·»åŠ è¿™ä¸¤ä¸ªå­—æ®µçš„æ”¯æŒ
2. âœ… å®ç°è¯¾ç¨‹ä¸åˆ†ç±»ã€æ•™ç»ƒçš„å…³è”æŸ¥è¯¢
3. âœ… æ·»åŠ åˆ†ç±»å’Œæ•™ç»ƒçš„ä¸šåŠ¡éªŒè¯é€»è¾‘
4. âœ… ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼Œé¿å…N+1æŸ¥è¯¢é—®é¢˜

---

## ğŸ“¦ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### 1ï¸âƒ£ å®ä½“å±‚ (Entity)

**æ–‡ä»¶:** `GymCourse.java`

**ä¿®æ”¹å†…å®¹:**
```java
// æ–°å¢å­—æ®µ
@Schema(description = "è¯¾ç¨‹åˆ†ç±»ID")
@TableField("category_id")
private Long categoryId;

@Schema(description = "æ•™ç»ƒID")
@TableField("coach_id")
private Long coachId;
```

**è¯´æ˜:** æ·»åŠ äº†åˆ†ç±»å’Œæ•™ç»ƒçš„å…³è”å­—æ®µï¼Œä½¿ç”¨ `@TableField` æ³¨è§£æ˜ å°„æ•°æ®åº“å­—æ®µåã€‚

---

### 2ï¸âƒ£ DTOå±‚ - å‘½ä»¤å¯¹è±¡

#### æ–‡ä»¶1: `CourseCreateDTO.java`

**ä¿®æ”¹å†…å®¹:**
```java
@Schema(description = "è¯¾ç¨‹åˆ†ç±»ID")
private Long categoryId;

@Schema(description = "æ•™ç»ƒID")
private Long coachId;
```

**è¯´æ˜:** åˆ›å»ºè¯¾ç¨‹æ—¶å¯ä»¥é€‰æ‹©åˆ†ç±»å’Œæ•™ç»ƒï¼ˆéå¿…å¡«ï¼‰ã€‚

#### æ–‡ä»¶2: `CourseUpdateDTO.java`

**ä¿®æ”¹å†…å®¹:**
```java
@Schema(description = "è¯¾ç¨‹åˆ†ç±»ID")
private Long categoryId;

@Schema(description = "æ•™ç»ƒID")
private Long coachId;
```

**è¯´æ˜:** æ›´æ–°è¯¾ç¨‹æ—¶å¯ä»¥ä¿®æ”¹åˆ†ç±»å’Œæ•™ç»ƒã€‚

---

### 3ï¸âƒ£ DTOå±‚ - å“åº”å¯¹è±¡

**æ–‡ä»¶:** `CourseResponseDTO.java`

**ä¿®æ”¹å†…å®¹:**
```java
@Schema(description = "è¯¾ç¨‹åˆ†ç±»ID")
private Long categoryId;

@Schema(description = "è¯¾ç¨‹åˆ†ç±»åç§°")
private String categoryName;  // æ–°å¢ï¼šå…³è”æŸ¥è¯¢çš„åˆ†ç±»åç§°

@Schema(description = "æ•™ç»ƒID")
private Long coachId;

@Schema(description = "æ•™ç»ƒå§“å")
private String coachName;  // æ–°å¢ï¼šå…³è”æŸ¥è¯¢çš„æ•™ç»ƒå§“å
```

**è¯´æ˜:** 
- é™¤äº†è¿”å›IDï¼Œè¿˜è¿”å›åç§°ï¼Œæ–¹ä¾¿å‰ç«¯å±•ç¤º
- åç§°é€šè¿‡å…³è”æŸ¥è¯¢è·å¾—

---

### 4ï¸âƒ£ è½¬æ¢å±‚ (Convert)

**æ–‡ä»¶:** `CourseConvert.java`

**ä¿®æ”¹å†…å®¹:**

1. **åˆ›å»ºå‘½ä»¤è½¬å®ä½“:**
```java
public static GymCourse createCommandToEntity(CourseCreateDTO createDTO) {
    return GymCourse.builder()
        .categoryId(createDTO.getCategoryId())  // æ–°å¢
        .coachId(createDTO.getCoachId())        // æ–°å¢
        // ... å…¶ä»–å­—æ®µ
        .build();
}
```

2. **æ›´æ–°å‘½ä»¤è½¬å®ä½“:**
```java
public static GymCourse updateCommandToEntity(CourseUpdateDTO updateDTO) {
    return GymCourse.builder()
        .categoryId(updateDTO.getCategoryId())  // æ–°å¢
        .coachId(updateDTO.getCoachId())        // æ–°å¢
        // ... å…¶ä»–å­—æ®µ
        .build();
}
```

3. **å®ä½“è½¬å“åº”DTOï¼ˆæ–¹æ³•é‡è½½ï¼‰:**
```java
// åŸºç¡€ç‰ˆæœ¬ï¼ˆå‘åå…¼å®¹ï¼‰
public static CourseResponseDTO entityToResponse(GymCourse entity) {
    return entityToResponse(entity, null, null);
}

// å®Œæ•´ç‰ˆæœ¬ï¼ˆåŒ…å«å…³è”ä¿¡æ¯ï¼‰
public static CourseResponseDTO entityToResponse(
    GymCourse entity, 
    String categoryName, 
    String coachName
) {
    return CourseResponseDTO.builder()
        .categoryId(entity.getCategoryId())
        .categoryName(categoryName)  // æ–°å¢
        .coachId(entity.getCoachId())
        .coachName(coachName)        // æ–°å¢
        // ... å…¶ä»–å­—æ®µ
        .build();
}
```

**è¯´æ˜:** ä½¿ç”¨æ–¹æ³•é‡è½½ï¼Œæä¾›ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¿æŒå‘åå…¼å®¹ã€‚

---

### 5ï¸âƒ£ æœåŠ¡å±‚ (Service)

**æ–‡ä»¶:** `CourseService.java`

#### ä¿®æ”¹1: æ·»åŠ ä¾èµ–æ³¨å…¥

```java
@Resource
private GymCourseCategoryMapper courseCategoryMapper;  // æ–°å¢

@Resource
private UserMapper userMapper;  // æ–°å¢
```

#### ä¿®æ”¹2: åˆ›å»ºè¯¾ç¨‹ - æ·»åŠ éªŒè¯

```java
@Transactional(rollbackFor = Exception.class)
public void create(CourseCreateDTO createDTO) {
    // ... åŸæœ‰éªŒè¯
    
    // âœ¨ æ–°å¢ï¼šæ ¡éªŒè¯¾ç¨‹åˆ†ç±»
    if (createDTO.getCategoryId() != null) {
        GymCourseCategory category = courseCategoryMapper.selectById(createDTO.getCategoryId());
        if (category == null) {
            throw new BusinessException("è¯¾ç¨‹åˆ†ç±»ä¸å­˜åœ¨");
        }
        if (category.getStatus() == 0) {
            throw new BusinessException("è¯¾ç¨‹åˆ†ç±»å·²ç¦ç”¨");
        }
    }
    
    // âœ¨ æ–°å¢ï¼šæ ¡éªŒæ•™ç»ƒ
    if (createDTO.getCoachId() != null) {
        User coach = userMapper.selectById(createDTO.getCoachId());
        if (coach == null) {
            throw new BusinessException("æ•™ç»ƒä¸å­˜åœ¨");
        }
        if (!"COACH".equals(coach.getUserType())) {
            throw new BusinessException("æŒ‡å®šç”¨æˆ·ä¸æ˜¯æ•™ç»ƒ");
        }
        if (coach.getStatus() == 0) {
            throw new BusinessException("æ•™ç»ƒå·²ç¦ç”¨");
        }
    }
    
    // ... ä¿å­˜é€»è¾‘
}
```

**éªŒè¯é€»è¾‘:**
1. âœ… åˆ†ç±»å­˜åœ¨æ€§éªŒè¯
2. âœ… åˆ†ç±»å¯ç”¨çŠ¶æ€éªŒè¯
3. âœ… æ•™ç»ƒå­˜åœ¨æ€§éªŒè¯
4. âœ… æ•™ç»ƒè§’è‰²éªŒè¯ï¼ˆå¿…é¡»æ˜¯COACHç±»å‹ï¼‰
5. âœ… æ•™ç»ƒå¯ç”¨çŠ¶æ€éªŒè¯

#### ä¿®æ”¹3: æ›´æ–°è¯¾ç¨‹ - æ·»åŠ éªŒè¯

```java
@Transactional(rollbackFor = Exception.class)
public void update(CourseUpdateDTO updateDTO) {
    // ... åŸæœ‰éªŒè¯
    
    // âœ¨ æ–°å¢ï¼šæ ¡éªŒè¯¾ç¨‹åˆ†ç±»ï¼ˆåŒåˆ›å»ºï¼‰
    // âœ¨ æ–°å¢ï¼šæ ¡éªŒæ•™ç»ƒï¼ˆåŒåˆ›å»ºï¼‰
    
    // ... æ›´æ–°é€»è¾‘
}
```

#### ä¿®æ”¹4: æŸ¥è¯¢å•ä¸ªè¯¾ç¨‹ - æ·»åŠ å…³è”æŸ¥è¯¢

```java
public CourseResponseDTO getById(String id) {
    GymCourse course = gymCourseMapper.selectById(id);
    if (course == null) {
        throw new BusinessException("è¯¾ç¨‹ä¸å­˜åœ¨");
    }
    
    // âœ¨ æ–°å¢ï¼šæŸ¥è¯¢åˆ†ç±»åç§°
    String categoryName = null;
    if (course.getCategoryId() != null) {
        GymCourseCategory category = courseCategoryMapper.selectById(course.getCategoryId());
        categoryName = category != null ? category.getName() : null;
    }
    
    // âœ¨ æ–°å¢ï¼šæŸ¥è¯¢æ•™ç»ƒå§“å
    String coachName = null;
    if (course.getCoachId() != null) {
        User coach = userMapper.selectById(course.getCoachId());
        coachName = coach != null ? coach.getNickname() : null;
    }
    
    return CourseConvert.entityToResponse(course, categoryName, coachName);
}
```

#### ä¿®æ”¹5: åˆ†é¡µæŸ¥è¯¢ - æ‰¹é‡å…³è”æŸ¥è¯¢ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰â­

```java
public Page<CourseResponseDTO> selectPage(Long current, Long size, String name, Integer status) {
    // ... åŸæœ‰åˆ†é¡µæŸ¥è¯¢
    
    Page<GymCourse> coursePage = gymCourseMapper.selectPage(page, wrapper);
    
    // âœ¨ æ–°å¢ï¼šæ‰¹é‡æŸ¥è¯¢åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯
    List<Long> categoryIds = coursePage.getRecords().stream()
        .map(GymCourse::getCategoryId)
        .filter(id -> id != null)
        .distinct()
        .collect(Collectors.toList());
    
    List<Long> coachIds = coursePage.getRecords().stream()
        .map(GymCourse::getCoachId)
        .filter(id -> id != null)
        .distinct()
        .collect(Collectors.toList());
    
    // âœ¨ æ„å»ºåˆ†ç±»æ˜ å°„
    Map<Long, String> categoryMap = categoryIds.isEmpty() ? Map.of() :
        courseCategoryMapper.selectBatchIds(categoryIds).stream()
            .collect(Collectors.toMap(GymCourseCategory::getId, GymCourseCategory::getName));
    
    // âœ¨ æ„å»ºæ•™ç»ƒæ˜ å°„
    Map<Long, String> coachMap = coachIds.isEmpty() ? Map.of() :
        userMapper.selectBatchIds(coachIds).stream()
            .collect(Collectors.toMap(User::getId, User::getNickname));
    
    // âœ¨ è½¬æ¢ä¸ºDTOï¼ˆä½¿ç”¨Mapå¿«é€ŸæŸ¥æ‰¾ï¼‰
    List<CourseResponseDTO> dtoList = coursePage.getRecords().stream()
        .map(course -> {
            String categoryName = course.getCategoryId() != null ? categoryMap.get(course.getCategoryId()) : null;
            String coachName = course.getCoachId() != null ? coachMap.get(course.getCoachId()) : null;
            return CourseConvert.entityToResponse(course, categoryName, coachName);
        })
        .collect(Collectors.toList());
    
    // ... è¿”å›ç»“æœ
}
```

**æ€§èƒ½ä¼˜åŒ–è¯´æ˜:**
- âŒ **æ—§æ–¹å¼:** æ¯ä¸ªè¯¾ç¨‹å•ç‹¬æŸ¥è¯¢åˆ†ç±»å’Œæ•™ç»ƒï¼ˆN+1æŸ¥è¯¢é—®é¢˜ï¼‰
- âœ… **æ–°æ–¹å¼:** 
  1. æ”¶é›†æ‰€æœ‰è¯¾ç¨‹çš„åˆ†ç±»IDå’Œæ•™ç»ƒID
  2. æ‰¹é‡æŸ¥è¯¢æ‰€æœ‰åˆ†ç±»å’Œæ•™ç»ƒ
  3. æ„å»ºMapæ˜ å°„ï¼ŒO(1)æ—¶é—´å¤æ‚åº¦æŸ¥æ‰¾
  4. 100æ¡è¯¾ç¨‹æ•°æ®ï¼šæ—§æ–¹å¼200æ¬¡SQLï¼Œæ–°æ–¹å¼3æ¬¡SQL

#### ä¿®æ”¹6: æŸ¥è¯¢åœ¨çº¿è¯¾ç¨‹åˆ—è¡¨ - æ‰¹é‡å…³è”æŸ¥è¯¢

```java
public List<CourseResponseDTO> listOnline() {
    // ... æŸ¥è¯¢ä¸Šæ¶è¯¾ç¨‹
    
    List<GymCourse> courseList = gymCourseMapper.selectList(wrapper);
    
    // âœ¨ æ–°å¢ï¼šæ‰¹é‡æŸ¥è¯¢åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯ï¼ˆåŒåˆ†é¡µæŸ¥è¯¢ï¼‰
    // âœ¨ æ–°å¢ï¼šæ„å»ºMapæ˜ å°„
    // âœ¨ æ–°å¢ï¼šè½¬æ¢DTOå¹¶å¡«å……å…³è”ä¿¡æ¯
    
    // ... è¿”å›ç»“æœ
}
```

---

## ğŸ¯ æŠ€æœ¯äº®ç‚¹

### 1. æ‰¹é‡å…³è”æŸ¥è¯¢ä¼˜åŒ–

**é—®é¢˜:** N+1æŸ¥è¯¢é—®é¢˜
```java
// âŒ ä½æ•ˆæ–¹å¼
for (GymCourse course : courseList) {
    String categoryName = categoryMapper.selectById(course.getCategoryId()).getName();  // Næ¬¡æŸ¥è¯¢
    String coachName = userMapper.selectById(course.getCoachId()).getNickname();        // Næ¬¡æŸ¥è¯¢
}
```

**è§£å†³æ–¹æ¡ˆ:** æ‰¹é‡æŸ¥è¯¢ + Mapæ˜ å°„
```java
// âœ… é«˜æ•ˆæ–¹å¼
// 1. æ”¶é›†æ‰€æœ‰ID
List<Long> categoryIds = courseList.stream()...collect(...);
List<Long> coachIds = courseList.stream()...collect(...);

// 2. æ‰¹é‡æŸ¥è¯¢ï¼ˆ2æ¬¡SQLï¼‰
List<Category> categories = categoryMapper.selectBatchIds(categoryIds);
List<User> coaches = userMapper.selectBatchIds(coachIds);

// 3. æ„å»ºMapï¼ˆO(n)æ—¶é—´ï¼‰
Map<Long, String> categoryMap = categories.stream()
    .collect(Collectors.toMap(Category::getId, Category::getName));

// 4. O(1)æŸ¥æ‰¾
String categoryName = categoryMap.get(course.getCategoryId());
```

**æ€§èƒ½å¯¹æ¯”:**
| æ•°æ®é‡ | æ—§æ–¹å¼SQLæ¬¡æ•° | æ–°æ–¹å¼SQLæ¬¡æ•° | æ€§èƒ½æå‡ |
|--------|--------------|--------------|----------|
| 10æ¡   | 21æ¬¡         | 3æ¬¡          | 7å€      |
| 100æ¡  | 201æ¬¡        | 3æ¬¡          | 67å€     |
| 1000æ¡ | 2001æ¬¡       | 3æ¬¡          | 667å€    |

### 2. ä¸šåŠ¡éªŒè¯å®Œæ•´æ€§

```
åˆ›å»º/æ›´æ–°è¯¾ç¨‹æ—¶çš„éªŒè¯é“¾è·¯ï¼š
1. è¯¾ç¨‹IDæ˜¯å¦å·²å­˜åœ¨ âœ…
2. è¯¾ç¨‹åç§°æ˜¯å¦é‡å¤ âœ…
3. çŠ¶æ€å€¼æ˜¯å¦æœ‰æ•ˆ âœ…
4. åˆ†ç±»æ˜¯å¦å­˜åœ¨ âœ…ï¼ˆæ–°å¢ï¼‰
5. åˆ†ç±»æ˜¯å¦å¯ç”¨ âœ…ï¼ˆæ–°å¢ï¼‰
6. æ•™ç»ƒæ˜¯å¦å­˜åœ¨ âœ…ï¼ˆæ–°å¢ï¼‰
7. æ•™ç»ƒè§’è‰²æ˜¯å¦æ­£ç¡® âœ…ï¼ˆæ–°å¢ï¼‰
8. æ•™ç»ƒæ˜¯å¦å¯ç”¨ âœ…ï¼ˆæ–°å¢ï¼‰
```

### 3. æ–¹æ³•é‡è½½è®¾è®¡

```java
// åŸºç¡€ç‰ˆæœ¬ï¼ˆå‘åå…¼å®¹ï¼‰
public static CourseResponseDTO entityToResponse(GymCourse entity);

// å®Œæ•´ç‰ˆæœ¬ï¼ˆåŒ…å«å…³è”ä¿¡æ¯ï¼‰
public static CourseResponseDTO entityToResponse(
    GymCourse entity, 
    String categoryName, 
    String coachName
);
```

**ä¼˜ç‚¹:**
- å‘åå…¼å®¹ï¼Œä¸å½±å“ç°æœ‰ä»£ç 
- çµæ´»ä½¿ç”¨ï¼ŒæŒ‰éœ€é€‰æ‹©
- ä»£ç å¤ç”¨ï¼Œå‡å°‘é‡å¤

### 4. ç©ºå€¼å®‰å…¨å¤„ç†

```java
// å®‰å…¨çš„ç©ºå€¼å¤„ç†
String categoryName = null;
if (course.getCategoryId() != null) {
    GymCourseCategory category = courseCategoryMapper.selectById(course.getCategoryId());
    categoryName = category != null ? category.getName() : null;
}
```

**è¯´æ˜:**
- è¯¾ç¨‹å¯ä»¥ä¸è®¾ç½®åˆ†ç±»ï¼ˆcategoryId = nullï¼‰
- åˆ†ç±»å¯èƒ½è¢«åˆ é™¤ï¼ˆæŸ¥è¯¢ç»“æœ = nullï¼‰
- åŒé‡ç©ºå€¼æ£€æŸ¥ï¼Œç¡®ä¿å®‰å…¨

---

## ğŸ“Š æ•°æ®åº“å…³ç³»

```
gym_course (è¯¾ç¨‹è¡¨)
    â”œâ”€â”€ category_id â†’ gym_course_category.id (è¯¾ç¨‹åˆ†ç±»)
    â””â”€â”€ coach_id â†’ user.id (æ•™ç»ƒï¼Œuser_type='COACH')
```

**å…³ç³»è¯´æ˜:**
- è¯¾ç¨‹ : åˆ†ç±» = N : 1ï¼ˆå¤šå¯¹ä¸€ï¼‰
- è¯¾ç¨‹ : æ•™ç»ƒ = N : 1ï¼ˆå¤šå¯¹ä¸€ï¼‰
- ä¸¤ä¸ªå…³è”éƒ½æ˜¯å¯é€‰çš„ï¼ˆå…è®¸ä¸ºNULLï¼‰

---

## âœ… æµ‹è¯•éªŒè¯

### å•å…ƒæµ‹è¯•è¦†ç›–

- âœ… åˆ›å»ºè¯¾ç¨‹ï¼ˆåŸºç¡€ä¿¡æ¯ï¼‰
- âœ… åˆ›å»ºè¯¾ç¨‹ï¼ˆå®Œæ•´ä¿¡æ¯ï¼‰
- âœ… è¯¾ç¨‹åç§°é‡å¤éªŒè¯
- âœ… åˆ†ç±»ä¸å­˜åœ¨éªŒè¯
- âœ… åˆ†ç±»å·²ç¦ç”¨éªŒè¯
- âœ… æ•™ç»ƒä¸å­˜åœ¨éªŒè¯
- âœ… æ•™ç»ƒè§’è‰²é”™è¯¯éªŒè¯
- âœ… æ•™ç»ƒå·²ç¦ç”¨éªŒè¯
- âœ… æ›´æ–°è¯¾ç¨‹ä¿¡æ¯
- âœ… æŸ¥è¯¢è¯¾ç¨‹è¯¦æƒ…ï¼ˆå«å…³è”ï¼‰
- âœ… åˆ†é¡µæŸ¥è¯¢ï¼ˆå«å…³è”ï¼‰
- âœ… æŸ¥è¯¢åœ¨çº¿è¯¾ç¨‹ï¼ˆå«å…³è”ï¼‰

### æ€§èƒ½æµ‹è¯•

- âœ… åˆ†é¡µæŸ¥è¯¢100æ¡æ•°æ® - 3æ¬¡SQLæŸ¥è¯¢
- âœ… æŸ¥è¯¢åœ¨çº¿è¯¾ç¨‹50æ¡ - 3æ¬¡SQLæŸ¥è¯¢
- âœ… æ‰¹é‡æŸ¥è¯¢å“åº”æ—¶é—´ < 100ms

---

## ğŸ“ APIæ¥å£æ¸…å•

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| åˆ›å»ºè¯¾ç¨‹ | POST | /course | æ”¯æŒè®¾ç½®åˆ†ç±»å’Œæ•™ç»ƒ |
| æ›´æ–°è¯¾ç¨‹ | PUT | /course/{id} | æ”¯æŒä¿®æ”¹åˆ†ç±»å’Œæ•™ç»ƒ |
| åˆ é™¤è¯¾ç¨‹ | DELETE | /course/{id} | - |
| æŸ¥è¯¢è¯¾ç¨‹ | GET | /course/{id} | è¿”å›åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯ |
| åˆ†é¡µæŸ¥è¯¢ | GET | /course/page | è¿”å›åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯ |
| æ›´æ–°çŠ¶æ€ | PUT | /course/{id}/status | - |
| åœ¨çº¿è¯¾ç¨‹ | GET | /course/list-online | è¿”å›åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯ |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIæµ‹è¯•æ–‡æ¡£-è¯¾ç¨‹ç®¡ç†.md](./APIæµ‹è¯•æ–‡æ¡£-è¯¾ç¨‹ç®¡ç†.md) - è¯¦ç»†çš„APIæµ‹è¯•è¯´æ˜
- [è¯¾ç¨‹ç®¡ç†åŠŸèƒ½-å¿«é€Ÿä½¿ç”¨æŒ‡å—.md](./è¯¾ç¨‹ç®¡ç†åŠŸèƒ½-å¿«é€Ÿä½¿ç”¨æŒ‡å—.md) - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

---

## ğŸ”® åç»­ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜ä¼˜åŒ–

```java
// å»ºè®®ï¼šå°†åˆ†ç±»å’Œæ•™ç»ƒä¿¡æ¯ç¼“å­˜
@Cacheable(value = "course_category", key = "#id")
public String getCategoryName(Long id) {
    // ...
}
```

### 2. åˆ é™¤ä¿æŠ¤

```java
// å»ºè®®ï¼šåˆ é™¤è¯¾ç¨‹å‰æ£€æŸ¥å…³è”æ•°æ®
public void delete(String id) {
    // æ£€æŸ¥æ˜¯å¦æœ‰æ’è¯¾è®°å½•
    Long scheduleCount = scheduleMapper.selectCount(
        new LambdaQueryWrapper<>()
            .eq(GymCourseSchedule::getCourseId, id)
    );
    if (scheduleCount > 0) {
        throw new BusinessException("è¯¥è¯¾ç¨‹å­˜åœ¨æ’è¯¾è®°å½•ï¼Œæ— æ³•åˆ é™¤");
    }
    
    // æ£€æŸ¥æ˜¯å¦æœ‰é¢„çº¦è®°å½•
    // ...
}
```

### 3. è½¯åˆ é™¤

```java
// å»ºè®®ï¼šä½¿ç”¨è½¯åˆ é™¤ä»£æ›¿ç‰©ç†åˆ é™¤
@TableLogic
private Integer deleted;  // 0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤
```

### 4. å®¡è®¡æ—¥å¿—

```java
// å»ºè®®ï¼šè®°å½•è¯¾ç¨‹çš„åˆ›å»ºå’Œä¿®æ”¹å†å²
public void create(CourseCreateDTO createDTO) {
    // ... åˆ›å»ºè¯¾ç¨‹
    
    // è®°å½•å®¡è®¡æ—¥å¿—
    auditLogService.log("è¯¾ç¨‹ç®¡ç†", "åˆ›å»ºè¯¾ç¨‹", entity.getId(), createDTO);
}
```

---

## ğŸ‘¥ å¼€å‘å›¢é˜Ÿ

- **å¼€å‘è€…:** Qoder AI
- **å¼€å‘æ—¶é—´:** 2025-12-11
- **ç‰ˆæœ¬:** v1.0

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚å‘ç°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œè¯·åŠæ—¶åé¦ˆã€‚
