# 训练计划字段修复说明

## 问题描述

教练端训练计划列表页面报错：
```
Unknown column 'execution_note' in 'field list'
```

## 原因分析

数据库表 `gym_training_plan_detail` 缺少以下字段：
- `execution_note` - 执行备注
- `actual_sets` - 实际完成组数
- `actual_reps` - 实际完成次数

但是后端实体类 `GymTrainingPlanDetail.java` 中已经定义了这些字段，导致查询时出现字段不存在的错误。

## 修复步骤

### 方法一：执行 SQL 脚本（推荐）

1. 打开 MySQL 客户端（Navicat、HeidiSQL 等）或命令行
2. 连接到 gym 数据库
3. 执行以下 SQL 文件：
   ```
   sql/database/fix_training_plan_detail_missing_columns.sql
   ```

### 方法二：手动执行 SQL

在 MySQL 中执行以下 SQL 语句：

```sql
USE gym;

-- 添加执行备注字段
ALTER TABLE `gym_training_plan_detail` 
ADD COLUMN `execution_note` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT NULL COMMENT '执行备注' AFTER `complete_time`;

-- 添加实际完成组数字段
ALTER TABLE `gym_training_plan_detail` 
ADD COLUMN `actual_sets` int NULL DEFAULT NULL COMMENT '实际完成组数' AFTER `execution_note`;

-- 添加实际完成次数字段
ALTER TABLE `gym_training_plan_detail` 
ADD COLUMN `actual_reps` int NULL DEFAULT NULL COMMENT '实际完成次数' AFTER `actual_sets`;
```

## 验证修复

执行完 SQL 后，可以通过以下方式验证：

### 1. 查看表结构
```sql
DESC gym_training_plan_detail;
```

确认字段列表中包含：
- execution_note
- actual_sets
- actual_reps

### 2. 重启后端服务

如果后端服务正在运行，建议重启一下（可选，一般不需要）。

### 3. 测试教练端训练计划功能

1. 登录教练端系统
2. 进入"训练计划"页面
3. 查看训练计划列表是否正常加载
4. 查看计划详情是否正常显示

## 影响范围

- **涉及表**: `gym_training_plan_detail`
- **影响功能**: 教练端训练计划管理
- **数据安全**: 仅添加新字段，不影响现有数据

## 相关文件

- 修复 SQL: `sql/database/fix_training_plan_detail_missing_columns.sql`
- 主 SQL 文件: `gym.sql` (已同步更新)
- 后端实体: `springboot/src/main/java/org/example/springboot/entity/GymTrainingPlanDetail.java`

## 注意事项

1. 请在执行 SQL 前备份数据库
2. 如果是生产环境，建议在非高峰期执行
3. 执行后无需重启应用，直接刷新页面即可
