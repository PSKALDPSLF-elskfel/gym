# 训练计划小程序端 - 快速使用指南

## 🚀 快速启动

### 第一步：执行数据库迁移

```bash
# 打开命令行，进入项目目录
cd D:\健身房预约小程序

# 执行数据库扩展脚本
mysql -u root -p gym_booking_system < springboot\database\training_plan_detail_extension.sql

# 输入数据库密码后，看到"训练计划明细表扩展完成!"表示成功
```

### 第二步：重启后端服务

```bash
# 进入后端目录
cd springboot

# 重新编译（可选，如果IDE已自动编译可跳过）
mvn clean package

# 启动服务
java -jar target\springboot-0.0.1-SNAPSHOT.jar
```

### 第三步：小程序端访问

1. 打开微信开发者工具
2. 导入uniapp项目（路径：`D:\健身房预约小程序\uniapp`）
3. 编译运行小程序
4. 在"我的"页面找到"训练计划"入口

---

## 📱 功能入口

### 方式1：从"我的"页面进入

```
我的页面
  ↓
点击"训练计划"菜单
  ↓
进入训练计划列表
```

### 方式2：直接导航（开发调试用）

```javascript
// 在任意页面跳转到训练计划列表
uni.navigateTo({
  url: '/pages/training-plan/list'
})

// 跳转到计划详情
uni.navigateTo({
  url: '/pages/training-plan/detail?id=1'
})

// 跳转到训练历史
uni.navigateTo({
  url: '/pages/training-plan/history'
})
```

---

## 🎯 核心功能使用

### 1. 查看训练计划列表

**步骤**：
1. 进入训练计划页面
2. 默认显示所有计划
3. 可切换状态筛选（全部/进行中/已结束）
4. 查看每个计划的完成进度
5. 点击卡片进入详情

**提示**：
- 进度条颜色渐变表示完成程度
- 绿色标签表示"进行中"，灰色表示"已结束"

### 2. 标记训练完成

**步骤**：
1. 进入训练计划详情页
2. 找到要完成的训练动作
3. 点击"标记完成"按钮
4. 在弹窗中填写：
   - 实际完成组数
   - 实际完成次数
   - 训练感受（可选）
5. 点击"确认"提交
6. 看到进度条更新，训练项变为绿色高亮

**提示**：
- 已结束的计划不能标记完成
- 已完成的项目可以点击"取消完成"撤销
- 训练感受最多200字

### 3. 查看训练历史

**步骤**：
1. 在训练计划详情页
2. 点击右上角"历史"按钮（或在菜单中找到）
3. 查看所有已完成的训练记录
4. 按时间倒序显示最近50条

**提示**：
- 显示实际完成的组数、次数
- 可以查看之前的训练感受
- 用于回顾训练进展

---

## 🔧 API接口说明

### 小程序端可用的API

```javascript
import { 
  getTrainingPlanPage,      // 查询计划列表
  getTrainingPlanById,      // 获取计划详情
  updateDetailCompletion,   // 标记完成
  calculateProgress,        // 获取进度
  getExecutionHistory       // 获取历史
} from '@/apis/trainingPlan.js'
```

### 使用示例

#### 1. 查询我的训练计划

```javascript
import { getUserInfo } from '@/utils/auth.js'
import { getTrainingPlanPage } from '@/apis/trainingPlan.js'

const userInfo = getUserInfo()

getTrainingPlanPage({
  currentPage: 1,
  pageSize: 10,
  userId: userInfo.id,
  status: 1  // 1=进行中, 0=已结束, null=全部
}, {
  success: (res) => {
    console.log('训练计划列表:', res.records)
    console.log('总数:', res.total)
  },
  fail: (err) => {
    console.error('查询失败:', err)
  }
})
```

#### 2. 标记训练完成

```javascript
import { updateDetailCompletion } from '@/apis/trainingPlan.js'

updateDetailCompletion(detailId, {
  isCompleted: 1,
  actualSets: 4,
  actualReps: 12,
  executionNote: '今天状态不错，完成得很顺利！'
}, {
  success: () => {
    uni.showToast({ title: '已标记完成', icon: 'success' })
  },
  fail: (err) => {
    uni.showToast({ title: err, icon: 'none' })
  }
})
```

#### 3. 获取计划进度

```javascript
import { calculateProgress } from '@/apis/trainingPlan.js'

calculateProgress(planId, {
  success: (progress) => {
    console.log('完成进度:', progress + '%')
  }
})
```

---

## 📊 数据结构说明

### 训练计划对象

```javascript
{
  id: 1,                           // 计划ID
  userId: 10,                      // 用户ID
  userNickname: "张三",            // 用户昵称
  coachId: 5,                      // 教练ID
  coachNickname: "李教练",         // 教练昵称
  name: "增肌训练计划",            // 计划名称
  goal: "增肌",                    // 训练目标
  startDate: "2025-01-01",         // 开始日期
  endDate: "2025-03-31",           // 结束日期
  status: 1,                       // 状态：1=进行中, 0=已结束
  remark: "注意休息",              // 备注
  createTime: "2025-01-01 10:00:00",  // 创建时间
  details: [...]                   // 训练明细列表
}
```

### 训练明细对象

```javascript
{
  id: 101,                         // 明细ID
  planId: 1,                       // 计划ID
  dayOfWeek: 1,                    // 星期几（1-7）
  actionId: 20,                    // 动作ID
  actionName: "深蹲",              // 动作名称
  sets: 4,                         // 计划组数
  reps: 12,                        // 计划次数
  weight: 60,                      // 重量(kg)
  duration: 30,                    // 时长(分钟)
  restTime: 90,                    // 组间休息(秒)
  isCompleted: 1,                  // 是否完成：0=未完成, 1=已完成
  completeTime: "2025-01-05 18:30:00",  // 完成时间
  actualSets: 4,                   // 实际完成组数
  actualReps: 10,                  // 实际完成次数
  executionNote: "感觉不错"        // 执行备注
}
```

---

## 🐛 常见问题

### Q1: 训练计划列表显示为空？

**可能原因**：
- 用户尚未创建训练计划
- 后台还未为用户分配计划
- 用户ID获取失败

**解决方法**：
1. 检查是否已登录
2. 在后台管理系统中为用户创建训练计划
3. 查看控制台是否有错误信息

### Q2: 无法标记完成？

**可能原因**：
- 训练计划已结束（status=0）
- 网络连接问题
- 后端服务未启动

**解决方法**：
1. 确认计划状态为"进行中"
2. 检查网络连接
3. 查看后端服务是否正常运行
4. 查看浏览器控制台错误信息

### Q3: 进度不更新？

**可能原因**：
- 页面未刷新
- 计算接口调用失败

**解决方法**：
1. 下拉刷新页面
2. 重新进入详情页
3. 检查控制台错误

### Q4: 训练感受保存失败？

**可能原因**：
- 超过字数限制（200字）
- 包含特殊字符

**解决方法**：
1. 减少字数至200字以内
2. 避免使用特殊符号

---

## 💡 使用技巧

### 技巧1：快速标记多个项目

按照每日训练顺序，从上到下逐个标记完成，可以快速记录训练进度。

### 技巧2：详细记录训练感受

在训练感受中可以记录：
- 今天的身体状态
- 动作是否标准
- 遇到的困难
- 需要改进的地方

这些信息可以帮助教练调整计划。

### 技巧3：定期查看历史记录

每周查看一次训练历史，可以：
- 了解自己的进步
- 发现训练规律
- 调整训练强度

### 技巧4：合理设置实际完成数

如果某次训练：
- 完成得很好：实际数 ≥ 计划数
- 完成得一般：实际数 = 计划数
- 没完成计划：实际数 < 计划数

这样可以真实反映训练情况。

---

## 📈 进度解读

### 进度百分比含义

- **0-30%**: 刚开始，需要坚持
- **30-60%**: 已过半，继续加油
- **60-90%**: 快完成了，冲刺阶段
- **90-100%**: 即将完成，很棒！

### 进度条颜色

- **蓝色渐变**: 标准进度显示
- **绿色高亮**: 已完成的训练项
- **灰色**: 未完成的训练项

---

## 🎨 界面说明

### 列表页面

```
┌─────────────────────────┐
│  全部  进行中  已结束    │  ← 状态筛选
├─────────────────────────┤
│ 增肌训练计划        进行中│
│ 训练目标: 增肌            │
│ 教练: 李教练              │
│ 周期: 2025-01-01 至 ...  │
│ ━━━━━━━━━━ 60%         │  ← 进度条
│ 创建于 2025-01-01        │
├─────────────────────────┤
│ ...更多计划...            │
└─────────────────────────┘
```

### 详情页面

```
┌─────────────────────────┐
│ 增肌训练计划        进行中│
│ 训练目标: 增肌            │
│ 指导教练: 李教练          │
│ ━━━━━━━━━━ 60%         │
├─────────────────────────┤
│ 周一                   3个动作│
│ ✓ 深蹲   [已完成]         │
│   4组 × 12次  60kg       │
│   实际: 4组 × 10次        │
│   感受: 今天状态不错...   │
│ ○ 卧推   [标记完成]       │
│   4组 × 10次  40kg       │
├─────────────────────────┤
│ 周三                   2个动作│
│ ...                      │
└─────────────────────────┘
```

---

## 🔗 相关文档

- [完整开发文档](./训练计划小程序端开发文档.md)
- [数据库迁移脚本](./springboot/database/training_plan_detail_extension.sql)
- [API接口文档](http://localhost:9090/doc.html)

---

## 📞 获取帮助

如遇到问题：
1. 查看本文档的常见问题部分
2. 查看完整开发文档
3. 检查后端日志
4. 查看小程序控制台错误

---

**文档版本**: v1.0  
**更新日期**: 2025-12-11  
**适用版本**: 健身房预约小程序 v1.0+
