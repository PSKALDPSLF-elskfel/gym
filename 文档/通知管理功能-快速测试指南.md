# 通知管理功能 - 快速测试指南

## 测试前准备

### 1. 启动后端服务
```bash
cd springboot
mvn spring-boot:run
```

### 2. 启动前端服务
```bash
cd vue3/manager
npm run dev
```

### 3. 登录管理后台
- 访问：http://localhost:5173
- 使用管理员账号登录

## 功能测试步骤

### 测试1：查看通知列表

1. 登录后台，点击左侧菜单"通知管理"
2. 验证点：
   - ✅ 页面正常加载
   - ✅ 显示通知列表（如果数据库有数据）
   - ✅ 分页功能正常
   - ✅ 表格列显示完整

### 测试2：筛选功能

1. 选择"通知类型"：系统通知
2. 点击"搜索"按钮
3. 验证点：
   - ✅ 筛选结果正确
   - ✅ 只显示系统通知类型的记录

4. 选择"目标用户类型"：小程序用户
5. 点击"搜索"按钮
6. 验证点：
   - ✅ 筛选结果正确
   - ✅ 只显示目标用户为小程序用户的记录

7. 点击"重置"按钮
8. 验证点：
   - ✅ 筛选条件被清空
   - ✅ 显示所有通知

### 测试3：发送系统通知

1. 点击"发送通知"按钮
2. 填写表单：
   - 通知类型：系统通知
   - 通知标题：测试系统通知
   - 通知内容：这是一条测试通知，用于验证通知管理功能是否正常工作
   - 目标用户类型：全部
   - 优先级：中
   - 是否需要已读：是

3. 点击"确定"按钮
4. 验证点：
   - ✅ 提示"发送成功"
   - ✅ 弹窗自动关闭
   - ✅ 列表自动刷新，显示新发送的通知
   - ✅ 通知状态显示为"已发送"

### 测试4：发送课程通知

1. 点击"发送通知"按钮
2. 填写表单：
   - 通知类型：课程相关
   - 通知标题：新课程上线通知
   - 通知内容：瑜伽基础课已上线，欢迎预约体验
   - 目标用户类型：小程序用户
   - 优先级：高
   - 关联业务ID：550e8400-e29b-41d4-a716-446655440001
   - 关联业务类型：课程
   - 是否需要已读：是

3. 点击"确定"按钮
4. 验证点：
   - ✅ 发送成功
   - ✅ 列表中显示新通知

### 测试5：查看通知详情

1. 找到刚刚发送的通知
2. 点击"详情"按钮
3. 验证点：
   - ✅ 详情弹窗正常打开
   - ✅ 显示所有字段信息
   - ✅ 通知类型、优先级等显示标签样式
   - ✅ 时间格式正确
   - ✅ 关联业务信息显示正确

### 测试6：删除通知

1. 选择一条测试通知
2. 点击"删除"按钮
3. 在确认对话框中点击"确定"
4. 验证点：
   - ✅ 提示"删除成功"
   - ✅ 列表自动刷新
   - ✅ 该通知已从列表中移除

5. 点击"删除"后，在确认对话框中点击"取消"
6. 验证点：
   - ✅ 通知未被删除
   - ✅ 列表保持不变

### 测试7：表格功能

1. 测试分页切换
   - 点击"下一页"按钮
   - 点击"上一页"按钮
   - 直接输入页码跳转
   - 验证点：✅ 分页功能正常

2. 测试每页数量切换
   - 修改每页显示条数（10/20/50/100）
   - 验证点：✅ 每页条数切换正常

### 测试8：表单验证

1. 点击"发送通知"按钮
2. 不填写任何信息，直接点击"确定"
3. 验证点：
   - ✅ 提示"请选择通知类型"

4. 只填写通知类型，点击"确定"
5. 验证点：
   - ✅ 提示"请输入通知标题"

6. 填写通知类型和标题，点击"确定"
7. 验证点：
   - ✅ 提示"请输入通知内容"

8. 填写前三项，但不选择目标用户类型，点击"确定"
9. 验证点：
   - ✅ 提示"请选择目标用户类型"

### 测试9：数据展示

验证以下列的显示效果：
- ✅ 通知类型标签颜色正确
  - 系统通知：蓝色
  - 预约提醒：绿色
  - 课程相关：橙色
  - 器材相关：紫色
  - 会员相关：红色

- ✅ 目标用户类型标签颜色正确
  - 小程序用户：蓝色
  - 管理员：红色
  - 教练：绿色
  - 全部：紫色

- ✅ 优先级标签颜色正确
  - 低：灰色
  - 中：橙色
  - 高：红色

- ✅ 状态标签颜色正确
  - 已删除：灰色
  - 已发送：绿色
  - 草稿：黄色

- ✅ 内容预览显示省略号（超长文本）
- ✅ 时间格式显示正确（YYYY-MM-DD HH:mm）

## 后端接口测试

### 使用Swagger测试
访问：http://localhost:8080/doc.html

### 测试接口1：获取通知列表
```
GET /notifications/admin/list?current=1&size=10
```

### 测试接口2：发送通知
```
POST /notifications/send
Content-Type: application/json

{
  "notificationType": "SYSTEM",
  "title": "测试通知",
  "content": "这是一条测试通知",
  "targetUserType": "ALL",
  "priority": 1,
  "isReadRequired": 1
}
```

### 测试接口3：删除通知
```
DELETE /notifications/admin/{notificationId}
```

## 数据库验证

### 1. 查看通知表
```sql
SELECT * FROM sys_notification ORDER BY create_time DESC LIMIT 10;
```

### 2. 查看通知读取记录表
```sql
SELECT * FROM sys_notification_read WHERE notification_id = ? LIMIT 10;
```

### 3. 验证群发通知
发送一条目标用户类型为"ALL"的通知后，执行：
```sql
SELECT COUNT(*) FROM sys_notification_read WHERE notification_id = ?;
```
应该能看到为所有用户创建了读取记录。

## 常见问题排查

### 问题1：页面无法访问
- 检查前端服务是否启动
- 检查路由配置是否正确
- 查看浏览器控制台是否有错误

### 问题2：接口调用失败
- 检查后端服务是否启动
- 查看后端日志错误信息
- 验证请求参数是否正确

### 问题3：列表数据不显示
- 检查数据库中是否有数据
- 查看网络请求是否成功
- 验证数据格式是否正确

### 问题4：发送通知后用户端看不到
- 检查用户类型是否匹配
- 验证用户状态是否正常（status=1）
- 查看sys_notification_read表是否创建了记录

## 测试结果记录

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|----------|----------|------|
| 查看通知列表 | 正常显示 | | ⬜ |
| 筛选功能 | 正常筛选 | | ⬜ |
| 发送系统通知 | 发送成功 | | ⬜ |
| 发送课程通知 | 发送成功 | | ⬜ |
| 查看通知详情 | 正常显示 | | ⬜ |
| 删除通知 | 删除成功 | | ⬜ |
| 表格功能 | 正常工作 | | ⬜ |
| 表单验证 | 验证正常 | | ⬜ |
| 数据展示 | 样式正确 | | ⬜ |

## 测试完成标准

- ✅ 所有功能测试用例通过
- ✅ 表单验证正确
- ✅ 数据展示样式正确
- ✅ 无明显性能问题
- ✅ 无控制台错误
- ✅ 数据库记录正确

## 注意事项

1. 测试时注意观察浏览器控制台，确保无错误信息
2. 发送测试通知后，记得及时清理测试数据
3. 测试完成后，可以保留1-2条测试数据作为示例
4. 如发现问题，记录详细的错误信息和复现步骤
